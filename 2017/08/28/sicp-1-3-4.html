<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SICP Solutions: Section 1.3.4</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/borland.css">
    
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
    
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SICP Solutions: Section 1.3.4</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="SICP Solutions: Section 1.3.4" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Section 1.3.4 - Procedures as Returned Values" />
<meta property="og:description" content="Section 1.3.4 - Procedures as Returned Values" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-08-28T16:32:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SICP Solutions: Section 1.3.4" />
<script type="application/ld+json">
{"description":"Section 1.3.4 - Procedures as Returned Values","headline":"SICP Solutions: Section 1.3.4","dateModified":"2017-08-28T16:32:00+00:00","datePublished":"2017-08-28T16:32:00+00:00","url":"/2017/08/28/sicp-1-3-4.html","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/08/28/sicp-1-3-4.html"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <nav>
  Nikos Fertakis
  
  <a href="/" >Home</a>
  
  <a href="/blog.html" >Blog</a>
  
  <a href="/about.html" >About</a>
  
</nav>

    <h1>SICP Solutions: Section 1.3.4</h1>

<p>
  28 Aug 2017
  
  
</p>

<h3 id="section-134---procedures-as-returned-values">Section 1.3.4 - Procedures as Returned Values</h3>

<h4 id="exercise-140">Exercise 1.40</h4>

<p><code class="language-plaintext highlighter-rouge">cubic</code> will create and return procedures that should be solved using Newton’s
method:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">cubic</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">cube</span> <span class="nv">x</span><span class="p">)</span>
                 <span class="p">(</span><span class="nb">*</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">x</span><span class="p">))</span>
                 <span class="p">(</span><span class="nb">*</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">)</span>
                 <span class="nv">c</span><span class="p">)))</span></code></pre></figure>

<h4 id="exercise-141">Exercise 1.41</h4>

<p>Defining <code class="language-plaintext highlighter-rouge">double</code> is quite simple:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">f</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">))))</span></code></pre></figure>

<p>All the fun comes when trying to calculate something like
<code class="language-plaintext highlighter-rouge">((double (double double)) inc)</code>.</p>

<p><code class="language-plaintext highlighter-rouge">(double double)</code> essentially returns a procedure that applies the original
prodecure 4 times. Therefore <code class="language-plaintext highlighter-rouge">(double (double double))</code> will apply what it
receives receives <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>∗</mo><mn>4</mn><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">4 * 4 = 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">16</span></span></span></span> times. So if we start from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn></mrow><annotation encoding="application/x-tex">5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span>:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="nv">&gt;</span> <span class="p">(((</span><span class="nf">double</span> <span class="p">(</span><span class="nf">double</span> <span class="nv">double</span><span class="p">))</span> <span class="nv">inc</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">; =&gt; 21</span></code></pre></figure>

<h4 id="exercise-142">Exercise 1.42</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="nv">g</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nf">g</span> <span class="nv">x</span><span class="p">))))</span></code></pre></figure>

<h4 id="exercise-143">Exercise 1.43</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">repeated</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
      <span class="nv">f</span>
      <span class="p">(</span><span class="nf">repeated</span> <span class="p">(</span><span class="nf">compose</span> <span class="nv">f</span> <span class="nv">f</span><span class="p">)</span> <span class="p">(</span><span class="nf">dec</span> <span class="nv">n</span><span class="p">))))</span></code></pre></figure>

<h4 id="exercise-144">Exercise 1.44</h4>

<p>Using the definition of <code class="language-plaintext highlighter-rouge">dx</code> from above:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">))</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">x</span> <span class="nv">dx</span><span class="p">)))</span>
                 <span class="mf">3.0</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">n-fold-smoothed</span> <span class="nv">f</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">repeated</span> <span class="p">(</span><span class="nf">smooth</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">n</span><span class="p">))</span></code></pre></figure>

<h4 id="exercise-145">Exercise 1.45</h4>

<p>So the general function would be something like:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">root-n</span> <span class="nv">x</span> <span class="nv">n</span> <span class="nv">damps</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">fixed-point-of-transform</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">x</span> <span class="p">(</span><span class="nb">expt</span> <span class="nv">y</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">repeated</span> <span class="nv">average-damp</span> <span class="nv">damps</span><span class="p">)</span>
    <span class="mf">1.0</span><span class="p">))</span></code></pre></figure>

<p>The parameter <code class="language-plaintext highlighter-rouge">damps</code> controls the number of repeated average damps.
Experimenting a bit showed that with 2 average damps we can calculate up to the
7th root. 3 average damps lets us calculate up to the 31st root. Using 4 damps
we were able to calculate at least up to the 512th root with no problems.</p>

<h4 id="exercise-146">Exercise 1.46</h4>

<p>We first define <code class="language-plaintext highlighter-rouge">iterative-improve</code>. Note that it returns an anonymous procedure
that itself creates and executes a recursive procedure:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iterative-improve</span> <span class="nv">good-enough?</span> <span class="nv">improve</span><span class="p">)</span>
  <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">guess</span><span class="p">)</span>
    <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">last-guess</span><span class="p">)</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">good-enough?</span> <span class="nv">last-guess</span><span class="p">)</span>
        <span class="nv">last-guess</span>
        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">improve</span> <span class="nv">last-guess</span><span class="p">))))</span>
    <span class="p">(</span><span class="nf">iter</span> <span class="nv">guess</span><span class="p">)))</span></code></pre></figure>

<p>Now we can implement <code class="language-plaintext highlighter-rouge">sqrt</code> and <code class="language-plaintext highlighter-rouge">fixed-point</code>:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">sqrt</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">iterative-improve</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">guess</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="p">(</span><span class="nf">square</span> <span class="nv">guess</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span> <span class="mf">0.001</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">guess</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">average</span> <span class="nv">guess</span> <span class="p">(</span><span class="nb">/</span> <span class="nv">x</span> <span class="nv">guess</span><span class="p">))))</span>
   <span class="mf">1.0</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">fixed-point</span> <span class="nv">f</span> <span class="nv">first-guess</span><span class="p">)</span>
  <span class="p">((</span><span class="nf">iterative-improve</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">guess</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">&lt;</span> <span class="p">(</span><span class="nb">abs</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">guess</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span> <span class="nv">tolerance</span><span class="p">))</span>
    <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">guess</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">guess</span><span class="p">)))</span>
   <span class="nv">first-guess</span><span class="p">))</span></code></pre></figure>

<p>This concludes Chapter 1. Onwards to Chapter 2 then!</p>



  </body>
</html>
