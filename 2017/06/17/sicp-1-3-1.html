<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SICP Solutions: Section 1.3.1</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/borland.css">
    
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SICP Solutions: Section 1.3.1</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="SICP Solutions: Section 1.3.1" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Section 1.3 - Formulating Abstractions With Higer-Order Procedures" />
<meta property="og:description" content="Section 1.3 - Formulating Abstractions With Higer-Order Procedures" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-06-17T08:15:15+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SICP Solutions: Section 1.3.1" />
<script type="application/ld+json">
{"description":"Section 1.3 - Formulating Abstractions With Higer-Order Procedures","headline":"SICP Solutions: Section 1.3.1","dateModified":"2017-06-17T08:15:15+00:00","datePublished":"2017-06-17T08:15:15+00:00","url":"/2017/06/17/sicp-1-3-1.html","mainEntityOfPage":{"@type":"WebPage","@id":"/2017/06/17/sicp-1-3-1.html"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <nav>
  Nikos Fertakis
  
  <a href="/" >Home</a>
  
  <a href="/blog.html" >Blog</a>
  
  <a href="/about.html" >About</a>
  
</nav>

    <h1>SICP Solutions: Section 1.3.1</h1>

<p>
  17 Jun 2017
  
  
</p>

<h2 id="section-13---formulating-abstractions-with-higer-order-procedures">Section 1.3 - Formulating Abstractions With Higer-Order Procedures</h2>

<h3 id="section-131---procedures-as-arguments">Section 1.3.1 - Procedures as Arguments</h3>

<h4 id="exercise-129">Exercise 1.29</h4>

<p>Here is the implementation of Simpson’s Rule. Note that we defined <code class="language-plaintext highlighter-rouge">h</code> as a
procedure with no arguments since we haven’t learned about <code class="language-plaintext highlighter-rouge">let</code> yet.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">integral-simon</span> <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">h</span><span class="p">)</span> <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">b</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">n</span><span class="p">))</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">y</span> <span class="nv">k</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">k</span> <span class="p">(</span><span class="nf">h</span><span class="p">))))</span>
                   <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="k">or</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="nv">k</span> <span class="nv">n</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
                         <span class="p">((</span><span class="nb">even?</span> <span class="nv">k</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
                         <span class="p">(</span><span class="k">else</span> <span class="mi">4</span><span class="p">))))</span>
  <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">y</span> <span class="mi">0</span> <span class="nv">inc</span> <span class="nv">n</span><span class="p">)</span>
     <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nf">h</span><span class="p">)</span> <span class="mf">3.0</span><span class="p">)))</span></code></pre></figure>

<p>And running it we can see that it converges faster than the previous solution:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="nv">&gt;</span> <span class="p">(</span><span class="nf">integral-simon</span> <span class="nv">cube</span> <span class="mf">0.0</span> <span class="mi">1</span> <span class="mi">100</span><span class="p">)</span>
<span class="mf">0.24999999999999992</span>
<span class="nv">&gt;</span> <span class="p">(</span><span class="nf">integral-simon</span> <span class="nv">cube</span> <span class="mf">0.0</span> <span class="mi">1</span> <span class="mi">1000</span><span class="p">)</span>
<span class="mf">0.2500000000000003</span></code></pre></figure>

<h4 id="exercise-130">Exercise 1.30</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum-iter</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
        <span class="nv">result</span>
        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">0</span><span class="p">))</span></code></pre></figure>

<h4 id="exercise-131">Exercise 1.31</h4>

<p><code class="language-plaintext highlighter-rouge">product</code> is very similar to sum:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">inc</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="mi">1</span> <span class="nv">n</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="mi">1</span>
      <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span>

<span class="c1">;; We can use it:</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">factorial</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">product</span> <span class="nv">identity</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="nv">n</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">wallis</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">even?</span> <span class="nv">a</span><span class="p">)</span>
                       <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span>
                       <span class="p">(</span><span class="nb">/</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">a</span> <span class="mi">2</span><span class="p">))))</span>
  <span class="p">(</span><span class="nb">*</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="mf">1.0</span> <span class="nv">inc</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1">;; Let's try</span>
<span class="p">(</span><span class="nf">wallis</span> <span class="mi">100</span><span class="p">)</span></code></pre></figure>

<p>And we can write the iterative version:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
        <span class="nv">result</span>
        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">*</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

<h4 id="exercise-132">Exercise 1.32</h4>

<p>This is a recursive version of <code class="language-plaintext highlighter-rouge">accumulate</code>:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="nv">null-value</span>
      <span class="p">(</span><span class="nf">combiner</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span></code></pre></figure>

<p>We can use it to build <code class="language-plaintext highlighter-rouge">sum</code> and <code class="language-plaintext highlighter-rouge">product</code>:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span></code></pre></figure>

<p>And we can write the iterative version:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">accumulate</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">result</span><span class="p">)</span>
    <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
        <span class="nv">result</span>
        <span class="p">(</span><span class="nf">iter</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">combiner</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)))))</span>
  <span class="p">(</span><span class="nf">iter</span> <span class="nv">a</span> <span class="nv">null-value</span><span class="p">))</span></code></pre></figure>

<h4 id="exercise-133">Exercise 1.33</h4>

<p>We just skip the <code class="language-plaintext highlighter-rouge">combiner</code> if the predicate is not satisfied:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">f</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="nv">a</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
      <span class="nv">null-value</span>
      <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">a</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">combiner</span>
           <span class="p">(</span><span class="nf">term</span> <span class="nv">a</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">f</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))</span>
          <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">f</span> <span class="nv">combiner</span> <span class="nv">null-value</span> <span class="nv">term</span> <span class="p">(</span><span class="nf">next</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">next</span> <span class="nv">b</span><span class="p">))))</span></code></pre></figure>

<p>Then we can define the procedure that generates the sum of squares of primes
between <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code>, and the procedure that generates the product of relative
primes less than <code class="language-plaintext highlighter-rouge">n</code>:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">sum-square-primes</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">prime?</span> <span class="nv">+</span> <span class="mi">0</span> <span class="nv">square</span> <span class="nv">a</span> <span class="nv">inc</span> <span class="nv">b</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">product-relative-primes</span> <span class="nv">n</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">relative-prime?</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">=</span> <span class="p">(</span><span class="nb">gcd</span> <span class="nv">a</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">filtered-accumulate</span> <span class="nv">relative-prime?</span> <span class="nv">*</span> <span class="mi">1</span> <span class="nv">identity</span> <span class="mi">1</span> <span class="nv">inc</span> <span class="p">(</span><span class="nb">-</span> <span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span></code></pre></figure>



  </body>
</html>
